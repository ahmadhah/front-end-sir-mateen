{"ast":null,"code":"import { persistReducer } from 'redux-persist';\nimport storage from 'redux-persist/lib/storage';\nimport { put, takeLatest } from 'redux-saga/effects';\nimport { getUserByToken } from './AuthCRUD';\nexport const actionTypes = {\n  Login: '[Login] Action',\n  Logout: '[Logout] Action',\n  Register: '[Register] Action',\n  UserRequested: '[Request User] Action',\n  UserLoaded: '[Load User] Auth API',\n  SetUser: '[Set User] Action'\n};\nconst initialAuthState = {\n  user: undefined,\n  accessToken: undefined\n};\nexport const reducer = persistReducer({\n  storage,\n  key: 'v100-demo1-auth',\n  whitelist: ['user', 'accessToken']\n}, function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialAuthState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  switch (action.type) {\n    case actionTypes.Login:\n      {\n        var _action$payload;\n        const accessToken = (_action$payload = action.payload) === null || _action$payload === void 0 ? void 0 : _action$payload.accessToken;\n        return {\n          accessToken,\n          user: undefined\n        };\n      }\n    case actionTypes.Register:\n      {\n        var _action$payload2;\n        const accessToken = (_action$payload2 = action.payload) === null || _action$payload2 === void 0 ? void 0 : _action$payload2.accessToken;\n        return {\n          accessToken,\n          user: undefined\n        };\n      }\n    case actionTypes.Logout:\n      {\n        return initialAuthState;\n      }\n    case actionTypes.UserRequested:\n      {\n        return {\n          ...state,\n          user: undefined\n        };\n      }\n    case actionTypes.UserLoaded:\n      {\n        var _action$payload3;\n        const user = (_action$payload3 = action.payload) === null || _action$payload3 === void 0 ? void 0 : _action$payload3.user;\n        return {\n          ...state,\n          user\n        };\n      }\n    case actionTypes.SetUser:\n      {\n        var _action$payload4;\n        const user = (_action$payload4 = action.payload) === null || _action$payload4 === void 0 ? void 0 : _action$payload4.user;\n        return {\n          ...state,\n          user\n        };\n      }\n    default:\n      return state;\n  }\n});\nexport const actions = {\n  login: accessToken => ({\n    type: actionTypes.Login,\n    payload: {\n      accessToken\n    }\n  }),\n  register: accessToken => ({\n    type: actionTypes.Register,\n    payload: {\n      accessToken\n    }\n  }),\n  logout: () => ({\n    type: actionTypes.Logout\n  }),\n  requestUser: () => ({\n    type: actionTypes.UserRequested\n  }),\n  fulfillUser: user => ({\n    type: actionTypes.UserLoaded,\n    payload: {\n      user\n    }\n  }),\n  setUser: user => ({\n    type: actionTypes.SetUser,\n    payload: {\n      user\n    }\n  })\n};\nexport function* saga() {\n  yield takeLatest(actionTypes.Login, function* loginSaga() {\n    yield put(actions.requestUser());\n  });\n  yield takeLatest(actionTypes.Register, function* registerSaga() {\n    yield put(actions.requestUser());\n  });\n  yield takeLatest(actionTypes.UserRequested, function* userRequested() {\n    const {\n      data: user\n    } = yield getUserByToken();\n    yield put(actions.fulfillUser(user));\n  });\n}","map":{"version":3,"names":["persistReducer","storage","put","takeLatest","getUserByToken","actionTypes","Login","Logout","Register","UserRequested","UserLoaded","SetUser","initialAuthState","user","undefined","accessToken","reducer","key","whitelist","state","action","type","payload","actions","login","register","logout","requestUser","fulfillUser","setUser","saga","loginSaga","registerSaga","userRequested","data"],"sources":["/Users/ahmadhannan/Downloads/fgfgfg/src/app/modules/auth/redux/AuthRedux.ts"],"sourcesContent":["import {Action} from '@reduxjs/toolkit'\r\nimport {persistReducer} from 'redux-persist'\r\nimport storage from 'redux-persist/lib/storage'\r\nimport {put, takeLatest} from 'redux-saga/effects'\r\nimport {UserModel} from '../models/UserModel'\r\nimport {getUserByToken} from './AuthCRUD'\r\n\r\nexport interface ActionWithPayload<T> extends Action {\r\n  payload?: T\r\n}\r\n\r\nexport const actionTypes = {\r\n  Login: '[Login] Action',\r\n  Logout: '[Logout] Action',\r\n  Register: '[Register] Action',\r\n  UserRequested: '[Request User] Action',\r\n  UserLoaded: '[Load User] Auth API',\r\n  SetUser: '[Set User] Action',\r\n}\r\n\r\nconst initialAuthState: IAuthState = {\r\n  user: undefined,\r\n  accessToken: undefined,\r\n}\r\n\r\nexport interface IAuthState {\r\n  user?: UserModel\r\n  accessToken?: string\r\n}\r\n\r\nexport const reducer = persistReducer(\r\n  {storage, key: 'v100-demo1-auth', whitelist: ['user', 'accessToken']},\r\n  (state: IAuthState = initialAuthState, action: ActionWithPayload<IAuthState>) => {\r\n    switch (action.type) {\r\n      case actionTypes.Login: {\r\n        const accessToken = action.payload?.accessToken\r\n        return {accessToken, user: undefined}\r\n      }\r\n\r\n      case actionTypes.Register: {\r\n        const accessToken = action.payload?.accessToken\r\n        return {accessToken, user: undefined}\r\n      }\r\n\r\n      case actionTypes.Logout: {\r\n        return initialAuthState\r\n      }\r\n\r\n      case actionTypes.UserRequested: {\r\n        return {...state, user: undefined}\r\n      }\r\n\r\n      case actionTypes.UserLoaded: {\r\n        const user = action.payload?.user\r\n        return {...state, user}\r\n      }\r\n\r\n      case actionTypes.SetUser: {\r\n        const user = action.payload?.user\r\n        return {...state, user}\r\n      }\r\n\r\n      default:\r\n        return state\r\n    }\r\n  }\r\n)\r\n\r\nexport const actions = {\r\n  login: (accessToken: string) => ({type: actionTypes.Login, payload: {accessToken}}),\r\n  register: (accessToken: string) => ({\r\n    type: actionTypes.Register,\r\n    payload: {accessToken},\r\n  }),\r\n  logout: () => ({type: actionTypes.Logout}),\r\n  requestUser: () => ({\r\n    type: actionTypes.UserRequested,\r\n  }),\r\n  fulfillUser: (user: UserModel) => ({type: actionTypes.UserLoaded, payload: {user}}),\r\n  setUser: (user: UserModel) => ({type: actionTypes.SetUser, payload: {user}}),\r\n}\r\n\r\nexport function* saga() {\r\n  yield takeLatest(actionTypes.Login, function* loginSaga() {\r\n    yield put(actions.requestUser())\r\n  })\r\n\r\n  yield takeLatest(actionTypes.Register, function* registerSaga() {\r\n    yield put(actions.requestUser())\r\n  })\r\n\r\n  yield takeLatest(actionTypes.UserRequested, function* userRequested() {\r\n    const {data: user} = yield getUserByToken()\r\n    yield put(actions.fulfillUser(user))\r\n  })\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}